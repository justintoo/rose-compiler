#!/usr/bin/env bash

shopt -s extglob
set -o errtrace
set -o errexit

ROSE_SH_BIN_HOME="$(cd "$(dirname "$0")" && pwd)"
ROSE_SH_HOME="$(cd "${ROSE_SH_BIN_HOME}/.." && pwd)"
ROSE_SH_SCRIPTS_DIR="${ROSE_SH_HOME}/lib"

#--------------------------------------------------------------------
# Modules
#--------------------------------------------------------------------
source "${ROSE_SH_SCRIPTS_DIR}/import.shinc" || false

import util/logging
import rose/help
import rose/compile

#--------------------------------------------------------------------
function rose::cli() {
#--------------------------------------------------------------------
  while (( "$#" )); do
      arg="$1"
      shift

      case "$arg" in
        -h|--help) rose::help "$@";;
        compile) rose::compile "$@";;
        *)
            rose::log::error "Unrecognized argument: $arg"
            rose::help "$@"
            ;;
      esac
  done
}

#--------------------------------------------------------------------
function rose::main() {
#--------------------------------------------------------------------
  rose::log::trace "Beginning execution of Rose::main"

  rose::cli "$@"
}

ROSE_CLI="${@:---help}"

rose::main "${ROSE_CLI}"

